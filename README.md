# üìÑ Proposta de projeto: negocia.ai
## G35 | Jo√£o Victor de Souza Campos | Nataly de Souza Cunha | Yasmin Ingrid Silva Min√°rio

## 1. Introdu√ß√£o

<p align="center">
  <img src="./img/bannerQI.png" alt="negocia.ai - capa do projeto" width="100%">
</p>

A QI Tech √© refer√™ncia no mercado de infraestrutura para solu√ß√µes financeiras digitais, com foco em criar tecnologias seguras, escal√°veis e inovadoras. Dentro desse ecossistema, o **Inovacamp QI Tech 2025** prop√µe o desenvolvimento de solu√ß√µes criativas no setor financeiro, aproximando participantes da realidade pr√°tica de produtos digitais e dos desafios regulat√≥rios.

O mercado de **empr√©stimos peer-to-peer (P2P)** tem ganhado for√ßa globalmente ao oferecer cr√©dito de forma direta entre pessoas, sem intermedi√°rios tradicionais como bancos. Essa modalidade promete mais agilidade, taxas potencialmente melhores e inclus√£o financeira de p√∫blicos que ficam √† margem do sistema banc√°rio. No entanto, ainda enfrenta problemas de confian√ßa, rigidez nas regras e dificuldade de avaliar riscos de cr√©dito com transpar√™ncia.

√â nesse contexto que surge o **negocia.ai**, um aplicativo de cr√©dito P2P que busca resolver as falhas atuais do setor e criar um ambiente mais justo, flex√≠vel e confi√°vel para tomadores e investidores.

---

## 2. Problema
O acesso a cr√©dito no modelo P2P tradicional ‚Äî e em muitos protocolos descentralizados ‚Äî ainda enfrenta barreiras significativas:

1. **Rigidez dos protocolos atuais (over-collateralized)**  
   A exig√™ncia de colaterais maiores que o valor do empr√©stimo restringe o acesso apenas a quem j√° tem liquidez, excluindo grande parte dos potenciais usu√°rios.

2. **Aus√™ncia de di√°logo entre as partes**  
   Plataformas automatizadas fixam taxas e prazos de forma imut√°vel, sem espa√ßo para negocia√ß√£o ou contraproposta. Isso reduz flexibilidade e ignora o perfil individual do tomador ou o apetite de risco do investidor.

3. **Assimetria de informa√ß√£o e fragilidade na an√°lise de cr√©dito**  
   Investidores t√™m dificuldade em avaliar o risco de emprestar devido √† falta de dados ou crit√©rios limitados. Sem m√©tricas confi√°veis, a inseguran√ßa reduz o incentivo a participar.

4. **Execu√ß√£o fr√°gil de contratos**  
   Sem garantias autom√°ticas de cumprimento das condi√ß√µes acordadas, negocia√ß√µes podem perder credibilidade e se tornar pouco confi√°veis.

**Impactos:**
- Exclus√£o de usu√°rios com baixo acesso a colateral.
- Baixa ades√£o de investidores por medo de inadimpl√™ncia.
- Experi√™ncia de uso limitada e desconfian√ßa no sistema.
- Perda de efici√™ncia em rela√ß√£o ao potencial do cr√©dito P2P.

---
<br>

<p align="center">
  <img src="./img/bannerSolucao.png" alt="negocia.ai - capa do projeto" width="100%">
</p>

## 3. Solu√ß√£o Proposta
O **negocia.ai** √© uma plataforma P2P de cr√©dito que conecta tomadores e investidores em um ambiente seguro, transparente e com espa√ßo para negocia√ß√£o direta. A solu√ß√£o se apoia em tr√™s pilares principais:

- **Negocia√ß√£o flex√≠vel**: tomadores e investidores podem fazer contrapropostas em taxa e prazo, recriando a din√¢mica de negocia√ß√£o do mundo real, mas com garantias digitais.  
- **An√°lise de cr√©dito transparente**: cada usu√°rio recebe um score de cr√©dito consolidado a partir de fontes externas (ex.: Serasa) e hist√≥rico interno da plataforma, reduzindo assimetria de informa√ß√£o e apoiando decis√µes mais seguras.  
- **Execu√ß√£o confi√°vel**: contratos s√£o formalizados digitalmente, garantindo rastreabilidade, clareza e automa√ß√£o de etapas cr√≠ticas.  

**Diferenciais em rela√ß√£o a solu√ß√µes existentes**:
- Espa√ßo real de negocia√ß√£o, e n√£o apenas ‚Äútake it or leave it‚Äù.
- Score h√≠brido (interno + externo), adaptado ao perfil e hist√≥rico do usu√°rio.
- Transpar√™ncia e rastreabilidade em todas as etapas, fortalecendo a confian√ßa.

**Principais benef√≠cios:**
- **Tomadores**: acesso a cr√©dito justo e flex√≠vel, mesmo sem colateral elevado.
- **Investidores**: maior clareza sobre risco, suporte na diversifica√ß√£o e prote√ß√£o contra inadimpl√™ncia.
- **Mercado**: inclus√£o financeira, mais efici√™ncia e fortalecimento do modelo P2P.

---

## 4. Objetivos do Projeto

### Objetivo Geral
Desenvolver uma plataforma de cr√©dito P2P que reduza barreiras de acesso, aumente a confian√ßa entre as partes e ofere√ßa um sistema de negocia√ß√£o transparente, flex√≠vel e seguro.

### Objetivos Espec√≠ficos
- Criar um **sistema de cadastro e valida√ß√£o antifraude** para onboarding confi√°vel.
- Implementar um **motor de score h√≠brido (interno + externo)** para avalia√ß√£o de risco.
- Oferecer **funcionalidades de solicita√ß√£o e oferta de cr√©dito** com espa√ßo para contraproposta.
- Desenvolver dashboards personalizados para **monitorar carteira, risco e hist√≥rico**.
- Garantir **execu√ß√£o autom√°tica e rastre√°vel** dos contratos.
 

---

## 5. Personas

### üßë Persona 1: O Tomador Planejado (Carlos)

**Nome:**	Carlos, 30 anos <br>
**Profiss√£o:**	Profissional de TI <br>
**Score:**	Excelente (790)

### Cen√°rio:
Carlos √© um profissional dedicado e financeiramente respons√°vel. Ele sempre pagou suas contas em dia e construiu um √≥timo score de cr√©dito ao longo dos anos. Ele quer fazer um curso de especializa√ß√£o em Intelig√™ncia Artificial que custa R$10.000, um investimento que pode alavancar seu sal√°rio em at√© 30% em um ano, mas ele n√£o quer descapitalizar sua reserva de emerg√™ncia.

### Objetivos:

- Conseguir um empr√©stimo de R$10.000 com o m√≠nimo de burocracia.

- Pagar uma taxa de juros justa, que reflita seu status de excelente pagador.

- Sentir que seu bom comportamento financeiro √© reconhecido e recompensado.

### Frustra√ß√µes (A Jornada que o trouxe at√© aqui):

- **A Frustra√ß√£o com os Grandes Bancos:** Carlos primeiro foi ao seu banco tradicional. Por ser cliente h√° anos, achou que teria uma boa oferta. O banco lhe ofereceu um cr√©dito pr√©-aprovado, mas com uma taxa de juros padr√£o, alta, a mesma que ofereceriam para algu√©m com score muito inferior. Ele se sentiu apenas mais um n√∫mero em uma planilha, e seu bom hist√≥rico n√£o valeu nada.

- **A Frustra√ß√£o com as Fintechs Tradicionais:** Em seguida, ele tentou uma fintech de cr√©dito conhecida. O processo foi r√°pido e digital, mas o algoritmo, apesar de reconhecer seu bom score, s√≥ liberou um limite de R$7.500 ‚Äì insuficiente para seu curso. N√£o havia canal para explicar seu objetivo ou para solicitar uma reavalia√ß√£o. A decis√£o foi final, fria e sem espa√ßo para di√°logo.

- **A Dor Principal do Carlos:** Ele percebe uma grande injusti√ßa no mercado. *"De que adianta eu ser um √≥timo pagador e ter um score excelente se, no final, sou tratado com as mesmas taxas abusivas ou com limites que n√£o atendem minha necessidade? Eu n√£o quero um favor, quero uma condi√ß√£o justa pelo meu bom perfil."*

### üë© Persona 2: A Investidora Estrat√©gica (Sofia)
**Nome:**	Sofia, 45 anos <br>
**Profiss√£o:**	Gerente de Projetos <br>
**Perfil de Investidora:**	Moderado

### Cen√°rio:
Sofia tem um bom capital guardado e busca diversificar seus investimentos. Ela j√° investe em op√ß√µes de renda fixa (CDB, Tesouro), mas est√° frustrada com a baixa rentabilidade. Ela tamb√©m tem a√ß√µes, mas n√£o gosta da volatilidade e da falta de controle.

### Objetivos:

- Obter uma rentabilidade superior √† da renda fixa tradicional.

- Investir em ativos com um risco controlado e previs√≠vel.

- Ter transpar√™ncia e controle sobre onde seu dinheiro est√° alocado.

### Frustra√ß√µes (O que a faz buscar alternativas):

- **Renda Fixa:** Retornos muito baixos, mal acompanham a infla√ß√£o.

- **Bolsa de Valores:** Muita volatilidade e requer um acompanhamento constante que ela n√£o tem tempo para fazer.

- **Outras Plataformas P2P:** Ela j√° explorou outras plataformas P2P, mas o modelo era uma "caixa-preta". Ela colocava o dinheiro em um "fundo" de risco moderado, mas n√£o sabia exatamente para quem estava emprestando. Ela n√£o tinha poder de escolha ou negocia√ß√£o.

- **A Oportunidade que Sofia V√™:** *"Eu quero investir em pessoas, n√£o apenas em siglas. Se uma plataforma pudesse me apresentar uma carteira de tomadores j√° pr√©-selecionados, com os melhores scores do Brasil, e me desse a chance de negociar um retorno justo diretamente com eles, eu teria o melhor dos dois mundos: risco baixo e rentabilidade atrativa."*

---

# Estrutura de Pastas do negocia.ai

```bash
src/
‚îî‚îÄ‚îÄ backend/
    ‚îî‚îÄ‚îÄ src/
        ‚îî‚îÄ‚îÄ app/
            ‚îú‚îÄ‚îÄ api/
            ‚îÇ   ‚îî‚îÄ‚îÄ routers.py
            ‚îú‚îÄ‚îÄ database/
            ‚îÇ   ‚îú‚îÄ‚îÄ create_database.sql
            ‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile
            ‚îú‚îÄ‚îÄ models/
            ‚îÇ   ‚îú‚îÄ‚îÄ negociacao.py
            ‚îÇ   ‚îú‚îÄ‚îÄ proposta.py
            ‚îÇ   ‚îî‚îÄ‚îÄ usuario.py
            ‚îÇ   ‚îî‚îÄ‚îÄ score.py
            ‚îÇ   ‚îî‚îÄ‚îÄ metricas_investidor.py
            ‚îú‚îÄ‚îÄ services/
            ‚îÇ   ‚îú‚îÄ‚îÄ api_score.py
            ‚îÇ   ‚îú‚îÄ‚îÄ blockchain.py
            ‚îÇ   ‚îú‚îÄ‚îÄ calculo_taxas_juros.py
            ‚îÇ   ‚îú‚îÄ‚îÄ dashboard.py
            ‚îÇ   ‚îú‚îÄ‚îÄ negociacao.py
            ‚îÇ   ‚îú‚îÄ‚îÄ proposta.py
            ‚îÇ   ‚îî‚îÄ‚îÄ usuario.py
            ‚îî‚îÄ‚îÄ model/
                ‚îî‚îÄ‚îÄ model_analise_credito.py
        ‚îú‚îÄ‚îÄ config.py
        ‚îú‚îÄ‚îÄ Dockerfile
        ‚îú‚îÄ‚îÄ requirements.txt
        ‚îî‚îÄ‚îÄ docker-compose.yml
    frontend/
    ‚îî‚îÄ‚îÄsrc/
          ‚îú‚îÄ‚îÄ assets/
          ‚îÇ   ‚îú‚îÄ‚îÄ fonts/
          ‚îÇ   ‚îî‚îÄ‚îÄ images/
          ‚îú‚îÄ‚îÄ components/
          ‚îÇ   ‚îú‚îÄ‚îÄ atoms/
          ‚îÇ   ‚îú‚îÄ‚îÄ molecules/
          ‚îÇ   ‚îî‚îÄ‚îÄ organisms/
          ‚îú‚îÄ‚îÄ contexts/
          ‚îÇ   ‚îî‚îÄ‚îÄ AuthContext.tsx
          ‚îú‚îÄ‚îÄ hooks/
          ‚îÇ   ‚îú‚îÄ‚îÄ useAuth.ts
          ‚îÇ   ‚îî‚îÄ‚îÄ useNegotiations.ts
          ‚îú‚îÄ‚îÄ navigation/
          ‚îÇ   ‚îú‚îÄ‚îÄ AppNavigator.tsx
          ‚îÇ   ‚îî‚îÄ‚îÄ AuthStack.tsx
          ‚îú‚îÄ‚îÄ screens/
          ‚îÇ   ‚îú‚îÄ‚îÄ Auth/
          ‚îÇ   ‚îú‚îÄ‚îÄ Borrower/
          ‚îÇ   ‚îî‚îÄ‚îÄ Investor/
          ‚îú‚îÄ‚îÄ services/
          ‚îÇ   ‚îî‚îÄ‚îÄ api.ts
          ‚îú‚îÄ‚îÄ styles/
          ‚îÇ   ‚îú‚îÄ‚îÄ colors.ts
          ‚îÇ   ‚îú‚îÄ‚îÄ spacing.ts
          ‚îÇ   ‚îî‚îÄ‚îÄ typography.ts
          ‚îú‚îÄ‚îÄ types/
          ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
          ‚îî‚îÄ‚îÄ utils/
              ‚îî‚îÄ‚îÄ formatters.ts
    bash
.env
README.md
```

## üìÇ src/backend/src

C√≥digo-fonte principal da aplica√ß√£o backend, organizado por camadas (API, database, models, services, ML).

### üìÇ app/api
- **routers.py**  
  Define as rotas da API (endpoints HTTP) do FastAPI.  
  Centraliza a orquestra√ß√£o dos servi√ßos e exp√µe as funcionalidades para o front-end/mobile.

### üìÇ app/database
- **create_database.sql**  
  Script SQL inicial para cria√ß√£o das tabelas e rela√ß√µes do banco de dados (Postgres).  
- **Dockerfile**  
  Dockerfile espec√≠fico para configurar a imagem do banco local (quando usado com `docker-compose`).

### üìÇ app/models
Cont√©m os modelos (entidades) que representam as tabelas do banco e objetos de neg√≥cio.  
- **negociacao.py** ‚Äì Modelo da negocia√ß√£o entre tomador e investidor.  
- **proposta.py** ‚Äì Modelo das propostas e contrapropostas.  
- **usuario.py** ‚Äì Modelo dos usu√°rios, incluindo dados cadastrais.  
- **score.py** ‚Äì Modelo das an√°lises de score de cr√©dito. 
- **metricas_investidor.py** ‚Äì Modelo das m√©tricas do investidor.

### üìÇ app/services
Servi√ßos e regras de neg√≥cio que d√£o suporte √†s rotas.  
- **api_score.py** ‚Äì Servi√ßo respons√°vel pela consulta/integra√ß√£o com API de score de cr√©dito (integrada ao Serasa).  
- **blockchain.py** ‚Äì Servi√ßo para intera√ß√£o com a blockchain Polygon (registro de contratos e leitura de hashes).  
- **calculo_taxas_juros.py** ‚Äì Fun√ß√µes auxiliares para c√°lculo de taxas e juros dos empr√©stimos.  
- **dashboard.py** ‚Äì Servi√ßo para agrega√ß√£o e c√°lculo de m√©tricas exibidas nas dashboards dos usu√°rios.  
- **negociacao.py** ‚Äì L√≥gica de neg√≥cio das negocia√ß√µes (cria√ß√£o, atualiza√ß√£o de status).  
- **proposta.py** ‚Äì L√≥gica de envio/valida√ß√£o de propostas e contrapropostas.  
- **usuario.py** ‚Äì Servi√ßo para cadastro, login e gest√£o de dados de usu√°rios.  

### üìÇ model
- **model_analise_credito.py**  
  Implementa√ß√£o de modelo de an√°lise de cr√©dito (atrav√©s de machine learning).  
  Utilizado para classifica√ß√£o de risco de tomadores de empr√©stimo.

---

## ‚öôÔ∏è Arquivos de Configura√ß√£o

- **config.py**  
  Configura√ß√µes globais do backend (chaves de API, conex√µes de banco, par√¢metros de blockchain).  

- **Dockerfiles**  
  Dockerfile para empacotar e rodar o backend no ECS Fargate (ou localmente), e outro para a constru√ß√£o da imagem do banco Postgres para testes locais, configurado de maneira an√°loga √† inst√¢ncia RDS (AWS) em produ√ß√£o.  

- **requirements.txt**  
  Lista de depend√™ncias Python (FastAPI, Web3.py, scikit-learn, entre demais utilit√°rios do aplicativo).  

- **docker-compose.yml**  
  Orquestra√ß√£o de containers para desenvolvimento local (ex.: Postgres + backend).  

- **.env**  
  Vari√°veis de ambiente sens√≠veis (senhas, tokens, chaves de API).  

- **README.md**  
  Documenta√ß√£o inicial do projeto, instru√ß√µes de setup e guia r√°pido.  


- Vis√£o geral da arquitetura (monolito, microservi√ßos, serverless, etc.)
- Componentes principais
- Fluxo de dados entre front-end, backend e blockchain
- Integra√ß√µes externas (ex.: APIs, parceiros)

## üìÇ src/frontend/src

C√≥digo-fonte principal da aplica√ß√£o mobile em React Native, organizado por funcionalidade e responsabilidade para garantir escalabilidade e manutenibilidade.

### üìÇ assets
Recursos est√°ticos da aplica√ß√£o.

- **fonts/** ‚Äì Arquivos de fontes customizadas (ex: `Inter-Regular.ttf`, `Inter-Bold.ttf`).  
- **images/** ‚Äì Imagens e √≠cones est√°ticos (ex: logo, √≠cone do trevo do estado vazio).  

### üìÇ components
Componentes de UI reutiliz√°veis, organizados seguindo uma abordagem inspirada no Atomic Design.

- **atoms/** ‚Äì Os menores componentes poss√≠veis, como `Button.tsx`, `Input.tsx`, `ScoreRing.tsx`. Eles s√£o os blocos de constru√ß√£o da UI.  
- **molecules/** ‚Äì Combina√ß√µes de √°tomos para formar componentes mais complexos, como `SearchBar.tsx` ou `LoanOfferCard.tsx`.  
- **organisms/** ‚Äì Se√ß√µes maiores da interface compostas por mol√©culas e/ou √°tomos, como `Header.tsx` ou `LoanList.tsx`.  

### üìÇ contexts
Gerenciamento de estado global com a Context API do React.  

- **AuthContext.tsx** ‚Äì Contexto para gerenciar o estado de autentica√ß√£o do usu√°rio (token, dados do usu√°rio logado).  

### üìÇ hooks
Hooks customizados que encapsulam l√≥gicas de neg√≥cio e intera√ß√µes com servi√ßos.

- **useAuth.ts** ‚Äì Hook para interagir com o `AuthContext`, provendo fun√ß√µes como `signIn`, `signOut`, `signUp`.  
- **useNegotiations.ts** ‚Äì Hook para buscar, criar e atualizar o estado das negocia√ß√µes de um usu√°rio.  

### üìÇ navigation
Configura√ß√£o da navega√ß√£o do app usando React Navigation.

- **AuthStack.tsx** ‚Äì Navegador do tipo *Stack* para o fluxo de autentica√ß√£o (Login, Cadastro, Sele√ß√£o de Perfil).  
- **AppNavigator.tsx** ‚Äì Navegador principal que controla a navega√ß√£o p√≥s-login, incluindo o *Tab Navigator* ou *Drawer*.  

### üìÇ screens
Cont√©m as telas completas da aplica√ß√£o, organizadas por fluxo.  

- **Auth/** ‚Äì Telas de `LoginScreen.tsx`, `SignUpScreen.tsx`, `ProfileSelectionScreen.tsx`.  
- **Borrower/** ‚Äì Telas do fluxo do Tomador: `DashboardScreen.tsx`, `OfferDetailsScreen.tsx`, `NegotiationScreen.tsx`, etc.  
- **Investor/** ‚Äì Telas do fluxo do Investidor: `DashboardScreen.tsx`, `SolicitationDetailsScreen.tsx`, `CounterProposalScreen.tsx`, etc.  

### üìÇ services
Camada respons√°vel pela comunica√ß√£o com APIs externas, principalmente o backend.  

- **api.ts** ‚Äì Configura√ß√£o da inst√¢ncia do Axios (ou outra lib HTTP), com URL base e interceptors.  

### üìÇ styles (ou theme)
Defini√ß√£o do Design System em c√≥digo.  

- **colors.ts** ‚Äì Exporta a paleta de cores (ex: `primaryBlue`, `investorPurple`, `warningYellow`).  
- **spacing.ts** ‚Äì Exporta tokens de espa√ßamento (ex: `spacing.md = 16`).  
- **typography.ts** ‚Äì Exporta estilos de fonte (ex: `H1`, `H2`, `Body`).  

### üìÇ types
Defini√ß√µes de tipos e interfaces TypeScript para garantir tipagem.  

- **index.ts** ‚Äì Exporta tipos como `User`, `LoanOffer`, `Negotiation`.  

### üìÇ utils
Fun√ß√µes auxiliares e utilit√°rias puras.  

- **formatters.ts** ‚Äì Fun√ß√µes para formatar valores, como `formatCurrency(10000)` ‚Üí `"R$10.000,00"`.  

## üõ†Ô∏è **Requisitos Funcionais**

| ID    | Descri√ß√£o                                                                                                                                                                                                                                                | Prioridade |
|-------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
| RF001 | **Cadastro e Onboarding de Usu√°rios**<br>O sistema deve permitir que novos usu√°rios (tomadores e investidores) se cadastrem fornecendo dados pessoais e documentos.                                                                                          | Alta       |
| RF002 | **Valida√ß√£o de Cadastro e Antifraude**<br>O sistema deve integrar-se com as APIs de Risk Solutions da QI Tech para valida√ß√£o de documentos, classifica√ß√£o de perfil e verifica√ß√£o antifraude durante o onboarding do usu√°rio.                                 | Alta       |
| RF003 | **C√°lculo/Aquisi√ß√£o de Score de Cr√©dito**<br>O sistema deve calcular um score de cr√©dito interno baseado em modelos de automa√ß√£o com intelig√™ncia artificial pr√≥prios e, em caso de dados insuficientes de usu√°rios novos, consultar a API do Serasa.         | Alta       |
| RF004 | **Gerenciamento de Perfil de Risco**<br>O sistema deve manter um perfil de risco atualizado para cada usu√°rio, baseado no score, hist√≥rico de empr√©stimos, dados de smart contracts e Open Finance (mockado inicialmente).                                   | M√©dia      |
| RF005 | **Solicita√ß√£o de Empr√©stimo**<br>O tomador deve poder solicitar um empr√©stimo informando o valor desejado, prazo e finalidade.                                                                                                                               | Alta       |
| RF006 | **Dashboard de Propostas de Empr√©stimo (Investidor)**<br>O sistema deve exibir para o investidor uma lista de empr√©stimos solicitados, com as taxas e juros sugeridos pelo tomador, juntamente com recomenda√ß√µes baseadas no perfil de risco do tomador.      | Alta       |
| RF007 | **Negocia√ß√£o de Taxas e Juros**<br>O investidor deve poder fazer uma proposta de taxa e juros diferente da sugerida pelo tomador. O tomador deve poder aceitar, recusar ou fazer uma contraproposta.                                                         | Alta       |
| RF008 | **Hist√≥rico de Negocia√ß√µes**<br>O sistema deve armazenar o hist√≥rico completo de todas as propostas e contrapropostas realizadas para cada solicita√ß√£o de empr√©stimo.                                                                                        | M√©dia      |
| RF009 | **Hist√≥rico de Empr√©stimos**<br>O sistema deve manter um hist√≥rico completo de todos os empr√©stimos de um usu√°rio, incluindo valor, taxas acordadas, tempo de vig√™ncia, status e dados do smart contract.                                                    | Alta       |
| RF010 | **Dashboard de Performance (Investidor)**<br>O sistema deve fornecer ao investidor um dashboard com m√©tricas de performance de sua carteira (ex: retorno total, taxa de inadimpl√™ncia, diversifica√ß√£o).                                                     | Alta       |
| RF011 | **Recomenda√ß√µes de Diversifica√ß√£o**<br>O sistema deve recomendar ao investidor oportunidades de diversifica√ß√£o de sua carteira, tanto em tipos de empr√©stimo quanto em perfis de tomadores.                                                                  | Baixa      |
| RF012 | **Integra√ß√£o com Open Finance (Futuro)**<br>O sistema deve ser preparado para uma futura integra√ß√£o com o Open Finance para enriquecer a an√°lise de perfil com dados transacionais reais.                                                                    | Baixa      |
| RF013 | **Navega√ß√£o entre Funcionalidades**<br>O sistema deve permitir que o usu√°rio navegue entre funcionalidades como investidor ou tomador de empr√©stimos.                                                                                                        | Alta       |
| RF014 | **C√°lculo de Margens de Taxas/Juros por Risco**<br>O sistema deve ser capaz de realizar c√°lculos de margens das taxas/juros por risco comumente aceitas nas negocia√ß√µes da plataforma, auxiliando tomadores e investidores no sucesso das negocia√ß√µes.        | Alta       |

---

## ‚ú® **Requisitos N√£o Funcionais**

| ID     | Categoria    | Descri√ß√£o                                                                                                                                                                                                                                         |
|--------|--------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| RNF001 | Seguran√ßa    | O sistema deve seguir as melhores pr√°ticas de seguran√ßa (OWASP), com todos os dados sens√≠veis criptografados em tr√¢nsito e em repouso.                                                                                                            |
| RNF002 | Desempenho   | As p√°ginas principais (login, dashboard) devem carregar em menos de 5 segundos em uma conex√£o de 3G. Para dados de menor volatilidade, as APIs devem responder em at√© 2 segundos para 95% das requisi√ß√µes, utilizando armazenamento local para otimiza√ß√£o das entregas. |
| RNF004 | Usabilidade  | A interface deve ser intuitiva, seguindo princ√≠pios de UX/UI, e responsiva, funcionando adequadamente em dispositivos desktop e m√≥veis.                                                                                                            |
| RNF005 | Confiabilidade | As transa√ß√µes financeiras e a execu√ß√£o dos smart contracts devem ser at√¥micas (n√£o podem falhar parcialmente) e garantir a consist√™ncia dos dados.                                                                                              |
| RNF006 | Escalabilidade | A arquitetura do sistema deve incluir sistema de filas para ser capaz de organizar as requisi√ß√µes e escalar horizontalmente, suportando um aumento de 10x no n√∫mero de usu√°rios sem degrada√ß√£o cr√≠tica do desempenho.                           |
| RNF007 | Integra√ß√£o   | As integra√ß√µes com APIs externas devem ser resilientes, com mecanismos de retry e fallback para lidar com indisponibilidades tempor√°rias.                                                                                                         |
| RNF008 | Conformidade | O sistema deve estar em conformidade com a LGPD (Lei Geral de Prote√ß√£o de Dados), garantindo o tratamento adequado dos dados pessoais dos usu√°rios.                                                         |

### Requisitos como User Stories

Esta subse√ß√£o apresenta os requisitos do projeto sob a forma de User Stories, facilitando o entendimento das necessidades reais do p√∫blico alvo da nossa solu√ß√£o.

### User Stories ‚Äî Requisitos Funcionais

#### 1. Cadastro e onboarding de usu√°rios

- **Como usu√°rio**, quero me cadastrar informando meus dados pessoais e documentos para que eu possa acessar a plataforma.
- **Como administrador**, quero que o sistema valide os dados do cadastro para evitar usu√°rios falsos.

---

#### 2. Valida√ß√£o de cadastro e antifraude

- **Como usu√°rio**, quero que meus documentos sejam verificados automaticamente para que eu tenha mais seguran√ßa no processo de cadastro.
- **Como administrador**, quero que o sistema integre com a QI Tech Risk Solutions para garantir que perfis fraudulentos sejam bloqueados.

---

#### 3. C√°lculo e aquisi√ß√£o de score de cr√©dito

- **Como investidor**, quero consultar o score de cr√©dito de um tomador para decidir se vou investir nele.
- **Como tomador**, quero que o sistema busque meu score do Serasa quando n√£o houver hist√≥rico interno, para que eu possa solicitar cr√©dito.

---

#### 4. Gerenciamento de perfil de risco

- **Como investidor**, quero acessar um perfil de risco consolidado de cada tomador para entender o risco antes de emprestar.
- **Como administrador**, quero que o sistema atualize perfis de risco dinamicamente a partir de score, hist√≥rico de empr√©stimos e dados do Open Finance (quando dispon√≠vel).

---

#### 5. Solicita√ß√£o de empr√©stimo

- **Como tomador**, quero solicitar um empr√©stimo informando valor, prazo, taxas e juros para obter recursos de forma r√°pida.

---

#### 6. Dashboard de propostas de empr√©stimo (investidor)

- **Como investidor**, quero visualizar todos os pedidos de empr√©stimos ativos com informa√ß√µes de score e taxas sugeridas para escolher onde investir.
- **Como investidor**, quero receber recomenda√ß√µes de empr√©stimos alinhados ao meu perfil de risco.

---

#### 7. Negocia√ß√£o de taxas e juros

- **Como investidor**, quero fazer uma proposta de taxa diferente da sugerida para tentar obter melhores condi√ß√µes.
- **Como tomador**, quero visualizar as contrapropostas de investidores e decidir se aceito, recuso ou fa√ßo outra contraproposta.

---

#### 8. Hist√≥rico de negocia√ß√µes

- **Como usu√°rio (investidor ou tomador)**, quero acessar o hist√≥rico de todas as propostas e contrapropostas de um empr√©stimo para acompanhar a negocia√ß√£o.

---

#### 9. Hist√≥rico de empr√©stimos

- **Como usu√°rio**, quero acessar meu hist√≥rico de empr√©stimos com informa√ß√µes sobre valores, prazos, taxas e status.

---

#### 10. Dashboard de performance (investidor)

- **Como investidor**, quero visualizar m√©tricas de performance da minha carteira (retorno total, taxa de inadimpl√™ncia, diversifica√ß√£o) para acompanhar meus resultados.

---

#### 11. Recomenda√ß√µes de diversifica√ß√£o

- **Como investidor**, quero receber sugest√µes de diversifica√ß√£o de carteira para reduzir riscos e equilibrar meu portf√≥lio.

---

#### 12. Integra√ß√£o com Open Finance (futuro)

- **Como administrador**, quero que o sistema esteja preparado para integrar dados do Open Finance no futuro para enriquecer os perfis de risco.

---

#### 13. Navega√ß√£o entre funcionalidades

- **Como usu√°rio**, quero poder alternar entre a aba de tomador e a aba de investidor para usar a plataforma tanto para pegar quanto para emprestar dinheiro.
- **Como sistema**, quero que o dashboard permita alternar entre as vis√µes de ‚Äúinvestidor‚Äù e ‚Äútomador‚Äù de forma fluida, garantindo consist√™ncia nos dados apresentados.

---

#### 14. C√°lculo de sugest√µes de taxas/juros

- **Como usu√°rio tomador ou investidor**, quero poder visualizar recomenda√ß√µes de taxas/juros mais aceitos dentre os usu√°rios da plataforma, para aumentar as minhas chances de sucesso de ofertas e contrapropostas.
- **Como sistema**, nas visualiza√ß√µes de oferta, proposta ou contraproposta, quero que seja mostrado ao usu√°rio frases de recomenda√ß√µes de taxas e juros, garantindo mecanismos de melhoria de negocia√ß√µes.

---

### User Stories ‚Äî Requisitos N√£o Funcionais

#### Seguran√ßa

- **Como usu√°rio**, quero que meus dados sejam criptografados em tr√¢nsito e em repouso para garantir privacidade.
- **Como administrador**, quero que o sistema siga pr√°ticas OWASP para mitigar ataques.

---

#### Desempenho

- **Como usu√°rio**, quero que o login e o dashboard carreguem em at√© 5 segundos mesmo em redes lentas para n√£o perder tempo.
- **Como usu√°rio**, quero que as respostas da API sejam r√°pidas para ter fluidez na navega√ß√£o.

---

#### Usabilidade

- **Como usu√°rio**, quero que a interface seja intuitiva e responsiva para usar facilmente no celular e no computador.

---

#### Confiabilidade

- **Como usu√°rio**, quero que as transa√ß√µes financeiras sejam at√¥micas e consistentes para n√£o perder dinheiro em caso de falhas.

---

#### Escalabilidade

- **Como administrador**, quero que o sistema consiga suportar 10x mais usu√°rios sem degrada√ß√£o de performance para acompanhar o crescimento.

---

#### Integra√ß√£o

- **Como sistema**, quero ter mecanismos de retry e fallback em APIs externas para n√£o prejudicar o usu√°rio em caso de indisponibilidade.

---

#### Conformidade

- **Como usu√°rio**, quero que o sistema esteja em conformidade com a LGPD para que meus dados pessoais sejam tratados corretamente.


---

## üèõÔ∏è Modelagem de dados e arquitetura

### Diagrama de Componentes

<div align="center">
<sub>Figura X - Diagrama de componentes + Cloud</sub><br>
<br>
<img src="./img/componentes.png" alt='Diagrama de componentes + Cloud' width="80%">
<br>
<br>
<sup>Fonte: Material produzido pelos autores (2025)</sup>
</div>
<br>

A arquitetura do aplicativo mobile negocia.ai foi desenhada para modularizar as principais partes da solu√ß√£o em componentes independentes, facilitando manuten√ß√£o, escalabilidade e integra√ß√£o cont√≠nua. Os tr√™s componentes centrais s√£o: banco de dados relacional, backend de servi√ßos e frontend mobile.

### Banco de Dados

<div align="center">
<sub>Figura X - Modelagem l√≥gica do banco de dados</sub><br>
<br>
<img src="./img/banco.png" alt='Modelagem l√≥gica do banco de dados' width="80%">
<br>
<br>
<sup>Fonte: Material produzido pelos autores (2025)</sup>
</div>
<br>

O banco de dados relacional utiliza PostgreSQL, encapsulado em uma imagem Docker para padroniza√ß√£o do ambiente de desenvolvimento e produ√ß√£o. Ele armazena informa√ß√µes em cinco tabelas principais:

- **usu√°rios**: dados cadastrais, valida√ß√£o e perfil.
- **negocia√ß√µes**: registros de negocia√ß√µes entre tomadores e investidores.
- **propostas**: termos de empr√©stimo, taxas, prazos, status e justificativas.
- **scores de cr√©dito**: resultados da an√°lise de cr√©dito, integrando machine learning e API Serasa.
- **m√©tricas do investidor**: dados de performance dos investimentos ofertados.

Os relacionamentos seguem as seguintes cardinalidades:

- Um usu√°rio possui um score de cr√©dito (1:1).
- Um usu√°rio pode participar de v√°rias negocia√ß√µes; cada negocia√ß√£o envolve dois usu√°rios (N:N), intermediada pela tabela de propostas.
- Um usu√°rio possui um registro √∫nico de m√©tricas de investidor (1:1).

O banco √© executado localmente via Docker e, em produ√ß√£o, √© provisionado em uma inst√¢ncia RDS (AWS), garantindo escalabilidade, seguran√ßa e alta disponibilidade.

### Backend

O backend √© desenvolvido em Python, utilizando frameworks como FastAPI para APIs REST e integra√ß√£o com servi√ßos externos (ex.: Serasa, Blockchain). Ele √© containerizado e executado em AWS ECS Fargate, eliminando a necessidade de gerenciamento manual de servidores.

Principais servi√ßos implementados:

- Gerenciamento de usu√°rios (cria√ß√£o, valida√ß√£o, autentica√ß√£o).
- Fluxos de negocia√ß√µes e propostas de empr√©stimo.
- Visualiza√ß√£o de m√©tricas de performance para investidores.
- C√°lculo de score de cr√©dito, integrando machine learning e API Serasa.
- Filtragem de ofertas e condi√ß√µes de empr√©stimo por perfil de risco.
- Registro de contratos de empr√©stimo na Blockchain Polygon.

A orquestra√ß√£o dos servi√ßos √© feita via containers, com deploy automatizado e escal√°vel.

### Frontend

O frontend √© desenvolvido em React Native, garantindo experi√™ncia nativa em dispositivos m√≥veis (Android/iOS) e integra√ß√£o direta com as APIs do backend. A escolha do React Native se d√° pela alta produtividade, comunidade ativa e facilidade de manuten√ß√£o multiplataforma. Por ser um aplicativo mobile nativo, o deploy √© realizado diretamente nas lojas de aplicativos, dispensando infraestrutura cloud dedicada para o frontend.

---

## üß† Motores de Decis√£o

### **1. Motor de Score**

#### 1) Objetivo

Calcular um **score final (0‚Äì1000)** que representa o risco de cr√©dito do usu√°rio como tomador combinando:

1.  **Fonte externa: Serasa** (para usu√°rios sem hist√≥rico ou com hist√≥rico curto na plataforma -> "**cold start**" e "**thin file**").
2.  **Fonte interna:** baseada em **modelo supervisionado**, que utiliza os dados do hist√≥rico operacional do usu√°rio na plataforma para estimar diretamente a **probabilidade de *default***. Essa probabilidade √© ent√£o convertida em um score cont√≠nuo de 0 a 1000, refinando a avalia√ß√£o de risco de cada tomador.

**Persistimos apenas:**

* `scores_credito.analise` (**JSON** com m√©tricas agregadas).
* `scores_credito.valor_score` (resultado final **0‚Äì1000**).

O rec√°lculo ocorre **1x ao dia (batch)** e tamb√©m **sob demanda via listener** ap√≥s atualizar `analise`.

#### 2) Escopo e Premissas

* O score **n√£o considera a√ß√µes como investidor** (emprestador); s√≥ como **tomador**.
* A an√°lise interna adota diretamente um **modelo supervisionado**, que utiliza r√≥tulos de inadimpl√™ncia e quita√ß√£o para treinar a previs√£o de risco. O modelo estima a **probabilidade de *default*** de cada tomador com base em seu hist√≥rico operacional e dados da plataforma, convertendo esse resultado em um score cont√≠nuo de **0 a 1000**. Dessa forma, a solu√ß√£o j√° nasce alinhada √†s pr√°ticas do mercado de cr√©dito e evolui em precis√£o conforme mais dados hist√≥ricos s√£o acumulados.

### **Fluxo Geral:**

<p align="center">
  <img src="docs/assets/fluxo_score.png" alt="Fluxo de Score" width="75%">
</p>


#### 3) Fontes de Dados

##### 3.1 Off-chain (Banco existente)

Tabelas principais j√° existentes (n√£o alterar):

* `usuarios`
* `negociacoes`
* `propostas`
* `scores_credito` (usaremos apenas `analise` e `valor_score` + `atualizado_em`)
* `metricas_investidor` (apenas se algum campo ajudar na extra√ß√£o; n√£o entra no score final por ser √≥tica do investidor)

##### 3.2 Externa

* **API Serasa** (score externo para *cold start* e composi√ß√£o do score final).

#### 4) Especifica√ß√£o do `analise`

O `analise` consolida somente m√©tricas de tomador:

```json
{
  "tempo_na_plataforma_meses": 0,
  "emprestimos_contratados": 0,
  "emprestimos_quitados": 0,
  "emprestimos_inadimplentes": 0,
  "taxa_inadimplencia": 0.0,
  "media_taxa_juros_paga": 0.0,
  "media_prazo_contratado": 0,
  "renda_mensal": 0.0,
  "endividamento_estimado": 0.0,
  "propostas_realizadas": 0,
  "propostas_aceitas": 0,
  "media_tempo_negociacao_dias": 0.0
}
```

#### 5) Coleta dos Dados (exemplos de SELECTs)

**Importante:** todos os filtros abaixo consideram o usu√°rio como tomador (ex: `negociacoes.id_tomador = :user_id`).

* **tempo_na_plataforma_meses**

    ```sql
    SELECT EXTRACT(EPOCH FROM (NOW() - u.criado_em)) / 2629800.0 AS meses
    FROM usuarios u
    WHERE u.id = :user_id;
    ```

* **emprestimos_contratados** (negocia√ß√£o ‚Äúfechada‚Äù = `assinado_em IS NOT NULL`)

    ```sql
    SELECT COUNT(*) FROM negociacoes n
    WHERE n.id_tomador = :user_id
      AND n.assinado_em IS NOT NULL;
    ```

* **emprestimos_quitados**

    ```sql
    SELECT COUNT(*) FROM negociacoes n
    WHERE n.id_tomador = :user_id AND n.status = 'quitado';
    ```

* **emprestimos_inadimplentes**

    ```sql
    SELECT COUNT(*) FROM negociacoes n
    WHERE n.id_tomador = :user_id AND n.status = 'inadimplente';
    ```

* **taxa_inadimplencia**

    ```sql
    WITH base AS (
      SELECT COUNT(*)::float AS total
      FROM negociacoes n
      WHERE n.id_tomador = :user_id AND n.assinado_em IS NOT NULL
    ), inad AS (
      SELECT COUNT(*)::float AS qte
      FROM negociacoes n
      WHERE n.id_tomador = :user_id AND n.status = 'inadimplente'
    )
    SELECT CASE WHEN base.total = 0 THEN 0 ELSE (inad.qte / base.total) END AS taxa
    FROM base, inad;
    ```

* **media_taxa_juros_paga / media_prazo_contratado** (assumindo proposta ‚Äúaceita‚Äù referencia os termos finais)

    ```sql
    SELECT AVG(p.taxa_juros_am) AS media_taxa,
          AVG(p.prazo_meses)   AS media_prazo
    FROM propostas p
    JOIN negociacoes n ON n.id = p.id_negociacoes
    WHERE n.id_tomador = :user_id
      AND n.assinado_em IS NOT NULL
      AND p.status = 'aceita';
    ```

* **renda_mensal**

    ```sql
    SELECT COALESCE(u.renda_mensal, 0) FROM usuarios u WHERE u.id = :user_id;
    ```

* **endividamento_estimado** (aprox.: soma valores aceitos e ainda vigentes $\div$ renda)

    ```sql
    WITH renda AS (
      SELECT COALESCE(u.renda_mensal, 0) AS renda FROM usuarios u WHERE u.id = :user_id
    ),
    divida AS (
      SELECT COALESCE(SUM(p.valor), 0) AS aberto
      FROM propostas p
      JOIN negociacoes n ON n.id = p.id_negociacoes
      WHERE n.id_tomador = :user_id
        AND n.status IN ('em andamento')
        AND p.status = 'aceita'
    )
    SELECT CASE WHEN renda.renda = 0 THEN 0 ELSE (divida.aberto / renda.renda) END AS endividamento
    FROM renda, divida;
    ```

* **propostas_realizadas / propostas_aceitas** (como tomador)

    ```sql
    SELECT
      SUM(CASE WHEN p.autor_tipo = 'tomador' THEN 1 ELSE 0 END) AS propostas_realizadas,
      SUM(CASE WHEN p.autor_tipo = 'tomador' AND p.status = 'aceita' THEN 1 ELSE 0 END) AS propostas_aceitas
    FROM propostas p
    JOIN negociacoes n ON n.id = p.id_negociacoes
    WHERE n.id_tomador = :user_id;
    ```

* **media_tempo_negociacao_dias** (da 1¬™ proposta do tomador at√© `assinado_em`)

    ```sql
    WITH first_prop AS (
      SELECT MIN(p.criado_em) AS primeira_data
      FROM propostas p
      JOIN negociacoes n ON n.id = p.id_negociacoes
      WHERE n.id_tomador = :user_id
        AND p.autor_tipo = 'tomador'
    ),
    assinada AS (
      SELECT AVG(EXTRACT(EPOCH FROM (n.assinado_em - fp.primeira_data)) / 86400.0) AS media_dias
      FROM negociacoes n CROSS JOIN first_prop fp
      WHERE n.id_tomador = :user_id
        AND n.assinado_em IS NOT NULL
        AND fp.primeira_data IS NOT NULL
    )
    SELECT COALESCE(media_dias, 0.0) FROM assinada;
    ```

Esses `SELECTs` s√£o executados pelo **Score Service** para montar o `analise`.

#### 6) Modelo Interno (Supervisionado)

##### 6.1 Abordagem para Score Interno

* **Por qu√™?** A solu√ß√£o de an√°lise de cr√©dito precisa gerar um score cont√≠nuo (0‚Äì1000) que reflita a probabilidade real de inadimpl√™ncia do tomador. Por isso, adotamos diretamente uma estrat√©gia **supervisionada**, alinhada √†s pr√°ticas consolidadas no mercado financeiro.
* **Abordagem Supervisionada:** Utilizamos dados do hist√≥rico operacional do usu√°rio na plataforma (`analise`), combinados com o status das negocia√ß√µes (**quitado vs. inadimplente**).
* O modelo adotado √© a **Logistic Regression**, por ser simples, explic√°vel e amplamente usada no mercado de cr√©dito. Esse ser√° o algoritmo de refer√™ncia para gera√ß√£o do score. Caso o volume e a complexidade dos dados aumentem significativamente, existe a possibilidade de migrar para modelos mais avan√ßados, como XGBoost ou LightGBM, mas apenas como evolu√ß√£o futura.
* Essa probabilidade de default (**PD**) √© ent√£o convertida em um score padronizado:
  ```
  score = round(1000 * (1 - prob_default))
  ```
* **Vantagens:** **Precis√£o**, **Escalabilidade** e **Alinhamento com mercado**.
* **Integra√ß√£o simples:** a sa√≠da √© um √∫nico valor cont√≠nuo (0‚Äì1000), armazenado em `valor_score`, enquanto os insumos ficam no campo `analise`.
* **Tecnologias:**
    * `scikit-learn` $\rightarrow$ **Logistic Regression**, baseline supervisionado.
    * `FastAPI` $\rightarrow$ expor o endpoint `/score`.
    * `SQLAlchemy` $\rightarrow$ coleta de dados.
    * **Batch di√°rio** $\rightarrow$ recalcula `analise` (features) e `valor_score` (score final).

##### 6.2 Pipeline do Modelo Interno

| Fase | Detalhes |
| :--- | :--- |
| **Extra√ß√£o** | Coletar o `analise` de todos os usu√°rios. Buscar r√≥tulos de cada negocia√ß√£o associada (`default` = 1 se inadimplente, 0 caso quitado/em dia). |
| **Prepara√ß√£o** | Convers√£o de tipos. **Imputa√ß√£o simples** (preencher valores ausentes com a mediana). **Normaliza√ß√£o** (`StandardScaler`). Divis√£o treino/teste: 80% treino, 20% teste, com estratifica√ß√£o. |
| **Treino** (semanal ou mensal) | Algoritmo oficial: **Logistic Regression**. O modelo aprende a prever a probabilidade de default (PD). Persist√™ncia: salvar `scaler` + `modelo` em `.joblib`. M√©tricas de avalia√ß√£o: AUC-ROC, KS Statistic. |
| **Infer√™ncia di√°ria** | Para cada usu√°rio ativo, coletar `analise` atualizado. Aplicar `scaler` + `modelo` treinado. Obter PD $\in [0,1]$. Converter em score interno 0‚Äì1000: $$\text{score}=\text{round}(1000\times(1-\text{PD}))$$ |

* **Exemplo:** Usu√°rio com PD = 0.25 $\rightarrow$ Score = 750.
* **Observa√ß√µes:** O pipeline √© determin√≠stico e audit√°vel. O c√°lculo di√°rio garante que mudan√ßas no comportamento do tomador sejam refletidas rapidamente.


#### 7) F√≥rmula do Score Final

**M√©dia simples** (configur√°vel por ENV; padr√£o 50/50):

```
final_score = round(0.5 * serasa_score + 0.5 * interno_score)
```

**Fallbacks:**

* Se Serasa indispon√≠vel $\rightarrow$ `final = interno_score`
* Se modelo interno indispon√≠vel $\rightarrow$ `final = serasa_score`

N√£o persistimos os intermedi√°rios; apenas `analise` e `valor_score` final.


#### 8) Orquestra√ß√£o (Batch di√°rio + Listener)

##### 8.1 Batch Di√°rio (02:00 America/Sao_Paulo)

1.  Para cada usu√°rio tomador ativo: Rodar `SELECTs` $\rightarrow$ montar `analise`.
2.  Atualizar `scores_credito.analise` (`UPDATE`).
3.  **Publicar evento** `score.analise.updated:{user_id}` (Redis Pub/Sub).

  **Score Worker (listener) consome evento:**
  
  * Busca `analise`.
  * Chama Serasa API (com **cache de 24h**).
  * Roda modelo interno (Logistic Regression).
  * Calcula `final_score` (0‚Äì1000).
  * Atualiza `scores_credito.valor_score` e `atualizado_em`.

##### 8.2 Listener (on demand)

Toda vez que a aplica√ß√£o fizer `UPDATE` em `scores_credito.analise`, publica o mesmo evento `score.analise.updated:{user_id}`. O fluxo do *worker* √© id√™ntico ao *batch*.

#### 9) Servi√ßo de An√°lise ‚Äî FastAPI

##### 9.1 Endpoints (privados, behind-auth)

* `POST /internal/analysis/recalculate/{user_id}`: Executa `SELECTs`, monta e salva `analise`, publica evento.
* `POST /internal/scores/recalculate/{user_id}`: For√ßa rec√°lculo completo (busca Serasa, roda modelo, salva `valor_score`).
* `POST /internal/scores/recalculate-batch`: Dispara batch di√°rio (com pagina√ß√£o).
* `GET /internal/scores/{user_id}`: Retorna `{ valor_score, atualizado_em }` (leitura do banco).
* `POST /internal/models/retrain`: Re-treina Logistic Regression (uso semanal/mensal).

##### 9.2 Stack e Opera√ß√£o

* **Stack:** FastAPI + Uvicorn, SQLAlchemy, Requests/HTTPX para Serasa, Redis (Pub/Sub).
* **Monitoramento:** Prometheus (`/metrics`) com dura√ß√£o de infer√™ncia e QPS.


#### 10) Integra√ß√£o Serasa

##### 10.1 Motivo de uso

* Atribuir score para usu√°rios novos sem hist√≥rico (**‚Äúcold start‚Äù**).
* Servir de componente externo complementar.

##### 10.2 Implementa√ß√£o

* Connector com **cache por 24h** (Redis) para reduzir custos e lat√™ncia.
* Circuit breaker + retry exponencial.

##### 10.3 Seguran√ßa & LGPD

* **N√£o persistir payload bruto** do Serasa.
* Armazenar apenas: `timestamp` de consulta e valor para composi√ß√£o (usado em mem√≥ria).


#### 11) Versionamento de Modelo e Reprodutibilidade

* `model_version`: string (ex.: `iforest-2025-09-27`).
* **Artefatos:** `scaler.joblib`, `model.joblib`.
* **Logs de infer√™ncia** incluem: `user_id`, `model_version`, `score_interno`, `serasa_used`, `final_score`, `latency_ms`.


#### 12) Observabilidade e Qualidade

* **M√©tricas:** porcentagem de usu√°rios com `final_score < 300`, mediana do score.
* **Sa√∫de:** taxas de erro Serasa, *cache hit ratio*.
* **Drift check:** monitorar varia√ß√£o de distribui√ß√£o dos *features* (KS-test simples em batch semanal).

#### 13) Resili√™ncia & Fallback

* Serasa indispon√≠vel $\rightarrow$ segue com interno.
* Modelo indispon√≠vel $\rightarrow$ segue com Serasa.
* Ambos indispon√≠veis $\rightarrow$ mant√©m √∫ltimo `valor_score` e loga incidente.

#### 14) Seguran√ßa

* Secrets via Vault/Secrets Manager.
* Conex√µes TLS, IP allowlist para Serasa.
* **Princ√≠pio do m√≠nimo privil√©gio** (somente SELECT/UPDATE nas colunas necess√°rias).


#### 15) Roadmap de Evolu√ß√£o (Modelo)

1.  **Fase 1:** Logistic Regression.
2.  **Fase 2:** Enriquecer features (sazonalidade, granularidade por parcela).
3.  **Fase 3:** Ensemble supervisionado (Logistic Regression + modelos de √°rvore, como XGBoost/LightGBM).

---

### üöÄ **2. Motor de Recomenda√ß√£o**

#### 1) Objetivo
Construir um mecanismo de recomenda√ß√£o que:
- **Para investidores**: sugira empr√©stimos que mantenham uma carteira diversificada (evitar concentra√ß√£o em apenas um perfil de risco).
- **Para tomadores**: sugira par√¢metros de taxa justos e alinhados tanto ao mercado quanto ao hist√≥rico do pr√≥prio usu√°rio.

A l√≥gica n√£o depende de Machine Learning neste est√°gio, mas de c√°lculos estat√≠sticos, filtros e regras de neg√≥cio. Isso garante simplicidade, interpretabilidade e performance, al√©m de atender diretamente √†s necessidades da solu√ß√£o.

#### 2) Escopo e Premissas
- **Investidores**:
  - Recebem recomenda√ß√µes de novos empr√©stimos no marketplace, baseadas em ranges de valor, taxa e prazo semelhantes aos j√° investidos, priorizando a diversifica√ß√£o da carteira.
  - Tamb√©m recebem sugest√µes de taxa de juros (`taxa_analisada`) quando desejam abrir uma nova proposta de investimento, combinando par√¢metros de mercado com seu hist√≥rico pessoal.
- **Tomadores**:
  - Recebem sugest√£o de taxa de juros (`taxa_analisada`) ao criar uma nova proposta de empr√©stimo, ajustada pela m√©dia de mercado e pelo hist√≥rico de propostas anteriores.
  - Tamb√©m recebem recomenda√ß√µes de solicita√ß√µes de empr√©stimos semelhantes √†s que j√° fizeram, organizadas por par√¢metros como prazo, valor e taxa.
- A recomenda√ß√£o n√£o substitui a decis√£o, apenas apoia com transpar√™ncia e mensagens claras no front.
- **Orquestra√ß√£o**:
  - **Sugest√£o de taxa (`taxa_analisada`)**:
    - **Investidores e Tomadores**: a sugest√£o √© calculada on-demand no front, no momento em que o usu√°rio informa valor + prazo de uma nova proposta.
    - O c√°lculo da taxa combina dados de mercado (faixa m√©dia por score) + hist√≥rico pessoal.
    - A `taxa_analisada` √© exibida em tela, podendo ser opcionalmente registrada em `analise_taxa` apenas para fins de auditoria/analytics.
  - **Recomenda√ß√µes de empr√©stimos (matching)**:
    - **Investidores**: listener recalcula recomenda√ß√µes sempre que um contrato novo √© assinado ou quando novas solicita√ß√µes entram no marketplace.
    - **Tomadores**: listener recalcula recomenda√ß√µes de solicita√ß√µes semelhantes sempre que o pr√≥prio usu√°rio cria/edita uma proposta ou quando h√° novas oportunidades no mercado.

### **Fluxo Geral**

![Fluxo da Recomenda√ß√£o](docs/assets/fluxo_recomendacao.png)


#### 3) Fontes de Dados
##### 3.1 Off-chain (Banco existente)
- `usuarios` ‚Üí perfil do investidor/tomador.
- `negociacoes` ‚Üí hist√≥rico de contratos fechados.
- `propostas` ‚Üí taxas, prazos e condi√ß√µes aceitas.
- `scores_credito` ‚Üí score final do tomador.
- `metricas_investidor` ‚Üí consolida√ß√£o da carteira (diversifica√ß√£o, hist√≥rico).

##### 3.2 Derivados Internos (calculados a partir do banco)
- **Faixas de mercado**: valores agregados que representam a m√©dia/mediana das taxas praticadas por faixa de score.
- **Exemplo**:
  - Score 800‚Äì1000 ‚Üí 10‚Äì13% a.m.
  - Score 500‚Äì799 ‚Üí 14‚Äì18% a.m.
  - Score <500 ‚Üí acima de 20% a.m.
- Esses dados n√£o v√™m de um sistema externo, mas s√£o recalculados internamente em batch di√°rio e usados como insumo para sugerir a `taxa_analisada`.

#### 4) L√≥gica de Recomenda√ß√£o
##### 4.1 Recomenda√ß√£o de Empr√©stimos/Solicita√ß√µes
- **Objetivo**: sugerir oportunidades relevantes (para investir ou para solicitar) que se encaixam melhor no perfil do usu√°rio.
- **Passos**:
  1. Coletar hist√≥rico do usu√°rio (investimentos ou solicita√ß√µes anteriores):
     - Valor m√©dio.
     - Faixa de taxa mais recorrente.
     - Prazo m√©dio.
     - Score dos tomadores com quem j√° se relacionou.
  2. Montar um array de solicita√ß√µes/empr√©stimos ativos no marketplace que batem com esse padr√£o.
  3. Ordenar esse array pelo grau de compatibilidade com o perfil.
- **Exibi√ß√£o no front**:
  - **Tela inicial** ‚Üí mostrar apenas o primeiro item da lista (recomenda√ß√£o principal).
  - **Bot√£o ‚ÄúVer todos‚Äù** ‚Üí exibir todas as oportunidades dispon√≠veis, mas com as mais compat√≠veis no topo.

##### 4.2 Recomenda√ß√£o de Taxa (`taxa_analisada`)
- **Objetivo**: apoiar o usu√°rio ao definir a taxa de uma nova proposta, equilibrando o hist√≥rico pessoal com a m√©dia de mercado.
- **Passos**:
  1. **Usu√°rio decide abrir nova oferta/solicita√ß√£o**:
     - Depois de tentar encontrar op√ß√µes existentes no marketplace, o usu√°rio escolhe abrir uma proposta nova.
  2. **Sistema sugere `taxa_analisada`**:
     - O sistema calcula a taxa sugerida com base em:
       - M√©dia de mercado (faixa de taxa por categoria de score).
       - Hist√≥rico do usu√°rio (taxas praticadas em propostas semelhantes calculadas em tempo real a partir dos par√¢metros digitados na tela de ‚ÄúEncontrar ofertas/solicita√ß√µes‚Äù, quando o usu√°rio digita os dados de seu empr√©stimo ideal).
     - Essa taxa √© exibida junto de mensagens de contexto (ex.: justa, alta, agressiva).
  3. **Usu√°rio revisa e confirma**:
     - O usu√°rio pode aceitar a taxa sugerida ou definir outra.
     - Nesse momento ele tamb√©m revisa os demais par√¢metros (valor, prazo, perfil de risco aceito).
- **Exibi√ß√£o no front**:
  - Mostrar a taxa sugerida.
  - Mostrar mensagens de contexto, como:
    - ‚ÄúVoc√™ definiu uma taxa justa e alinhada √† m√©dia de mercado para este perfil de risco. √ìtimo!‚Äù
    - ‚ÄúEsta taxa de juros √© muito alta para o mercado. Sua oferta pode ficar muito tempo sem interessados.‚Äù
- **Proposta √© criada no banco**:
  - S√≥ ap√≥s a confirma√ß√£o, a oferta/solicita√ß√£o √© registrada em `propostas`.
  - A `taxa_analisada` pode ser salva para auditoria.

#### 5) Fluxo T√©cnico (Front ‚Üî Back)
- **Cria√ß√£o de proposta (investidor ou tomador)**:
  1. **Usu√°rio decide abrir uma nova oferta/solicita√ß√£o**:
     - Ap√≥s consultar o marketplace e n√£o encontrar algo compat√≠vel, o usu√°rio opta por criar sua pr√≥pria proposta.
     - Neste momento, ele j√° informou valor e prazo no front.
  2. **Front solicita recomenda√ß√£o de taxa**:
     - O front envia os par√¢metros tempor√°rios (valor + prazo + score do tomador, se aplic√°vel) para o servi√ßo de recomenda√ß√£o.
     - O dado ainda n√£o foi persistido no banco, √© apenas input de tela.
  3. **Back calcula `taxa_analisada`**:
     - Com base em:
       - Faixa de mercado (m√©dia de taxas por score, derivada internamente a partir do hist√≥rico da plataforma).
       - Hist√≥rico do usu√°rio (taxas m√©dias de propostas anteriores semelhantes, filtradas por valor e prazo pr√≥ximos aos informados).
     - O back retorna:
       - `taxa_analisada` (valor sugerido).
       - `faixa_mercado` (ex.: `[11%, 14%]`) para compara√ß√£o.
  4. **Front exibe recomenda√ß√£o**:
     - Mostra a taxa sugerida (`taxa_analisada`).
     - Mostra mensagens de contexto de acordo com a posi√ß√£o da taxa escolhida pelo usu√°rio em rela√ß√£o √† `faixa_mercado`:
       - Dentro da faixa ‚Üí ‚ÄúTaxa justa e alinhada √† m√©dia de mercado.‚Äù
       - Acima da faixa ‚Üí ‚ÄúTaxa alta, pode demorar a atrair interessados.‚Äù
       - Abaixo da faixa ‚Üí ‚ÄúTaxa agressiva, pode atrair investidores rapidamente, mas avalie se √© sustent√°vel.‚Äù
  5. **Usu√°rio revisa e confirma**:
     - Pode aceitar a taxa sugerida ou definir outra.
     - Tamb√©m revisa demais par√¢metros (valor, prazo, perfis de risco aceitos, possibilidade de negocia√ß√£o).
  6. **Persist√™ncia no banco**:
     - S√≥ ao confirmar, o sistema cria o registro na tabela `propostas`.
     - A `taxa_analisada` pode ser opcionalmente salva em `analise_taxa` para auditoria/analytics, mas n√£o √© campo obrigat√≥rio da proposta.

#### 6) Servi√ßo de Recomenda√ß√£o ‚Äî FastAPI
##### Endpoints
- `GET /internal/recommendations/solicitacoes/{user_id}`
  ‚Üí retorna lista de empr√©stimos/solicita√ß√µes no marketplace, ordenados por compatibilidade com o perfil do usu√°rio (investidor ou tomador).
- `GET /internal/recommendations/taxa?user_id=...&valor=...&prazo=...`
  ‚Üí retorna `taxa_analisada` + faixa de mercado + mensagens de contexto para front exibir ao abrir nova proposta.
- `POST /internal/recommendations/recalculate/{user_id}`
  ‚Üí for√ßa rec√°lculo de m√©tricas do investidor (ex.: diversifica√ß√£o de carteira) e das recomenda√ß√µes de matching.

##### Stack
- FastAPI + Uvicorn.
- SQLAlchemy para m√©tricas de hist√≥rico.
- Redis ‚Üí listener para eventos (assinatura de contratos).

#### 8) Roadmap de Evolu√ß√£o
- **Fase 1 (MVP)**: l√≥gica de regras simples (ranges e m√©dias).
- **Fase 2**: enriquecimento com dados setoriais (agro, servi√ßos, etc.).
- **Fase 3**: poss√≠vel evolu√ß√£o para ML (learning-to-rank, collaborative filtering) caso base cres√ßa e justifique complexidade.

---

## üé® Introdu√ß√£o e Objetivo do Prot√≥tipo no Figma

Este documento detalha o fluxo de navega√ß√£o do **prot√≥tipo de alta fidelidade** do **Negoci.ai**, desenvolvido no **Figma**.

Devido ao tempo limitado do hackathon, nossa estrat√©gia foi focar na prototipa√ß√£o da **jornada principal** e do nosso maior diferencial competitivo: **o fluxo de negocia√ß√£o**.  
- O fluxo do **Tomador** est√° mais completo.  
- O fluxo do **Investidor** foi prototipado em momentos-chave para demonstrar consist√™ncia da interface e vis√£o da intera√ß√£o entre perfis.  
- Algumas telas est√£o marcadas como **[EM DESENVOLVIMENTO]** ou **[N√ÉO PROTOTIPADO]**.  

---

## üé® Legenda de Cores e Perfis

Para refor√ßar o contexto da navega√ß√£o, adotamos um sistema de cores consistente:  

- üîµ **Perfil Tomador** ‚Äì Azul `#57d9ff` como cor de destaque e a√ß√£o.  
- üü£ **Perfil Investidor** ‚Äì Roxo `#9B59B6` como cor de destaque e a√ß√£o.  

---

## üîµ Fluxo 1: Jornada do Tomador (Carlos) ‚Äì O Fluxo Principal

Jornada mais detalhada do prot√≥tipo, desde o **cadastro at√© a negocia√ß√£o** de um empr√©stimo.

### 1. Cadastro e Onboarding *(Cadastro 1-4 a 4-4)*
- Cria√ß√£o de conta com e-mail e senha.  
- Preenchimento de dados pessoais para an√°lise de cr√©dito.  
- Verifica√ß√£o facial (KYC ‚Äì *Know Your Customer*).  
- Tela final de sucesso com direcionamento para login.  

### 2. Login e Sele√ß√£o de Perfil *(Entrar 1-2, Entrar 2-2)*
- Ap√≥s login, usu√°rio escolhe entre **Tomador** ou **Investidor**.  
- Cards explicativos orientam sobre cada perfil.  
- Lembrete de como alternar entre perfis posteriormente.  

### 3. Dashboard do Tomador *(Dashboard Tomador)*
- **Anel de score** em destaque, com feedback visual do cr√©dito.  
- Cards de **Produtos ativos**: *Empr√©stimos* e *Negocia√ß√µes*.  
- Pontos de entrada para:  
  - **[EM DESENVOLVIMENTO]** Empr√©stimos Solicitados.  
  - **[EM DESENVOLVIMENTO]** Negocia√ß√µes de Ofertas (Tomador).  

### 4. O Core da Solu√ß√£o ‚Äì A Negocia√ß√£o
- **Passo 4a ‚Äì Descoberta**: Dashboard ‚Üí Detalhes da oferta.  
  - Lista de empr√©stimos dispon√≠veis.  
  - Usu√°rio visualiza condi√ß√µes propostas.  

- **Passo 4b ‚Äì A√ß√£o**: Detalhes da oferta.  
  - Op√ß√µes: *Aceitar oferta* ou *Iniciar negocia√ß√£o* (CTA principal).  

- **Passo 4c ‚Äì A Proposta** *(Negocia√ß√£o 1-2)*  
  - Compara√ß√£o entre oferta original e proposta do usu√°rio.  
  - Ajuste de taxa em *slider* com ‚ÄúZona sugerida‚Äù.  
  - Visualiza√ß√£o em tempo real da economia estimada.  
  - Justificativa escrita para humanizar a negocia√ß√£o.  

- **Passo 4d ‚Äì Sucesso** *(Negocia√ß√£o 2-2)*  
  - Confirma√ß√£o da proposta enviada.  
  - Orienta√ß√£o para acompanhar via notifica√ß√µes.  

---

## üü£ Fluxo 2: Jornada da Investidora (Sofia) ‚Äì O Fluxo Complementar

Prototipado para mostrar momentos cr√≠ticos de intera√ß√£o, mantendo consist√™ncia com o fluxo do Tomador.

### 1. Dashboard da Investidora *(Dashboard Investidor)*
- Interface muda para **roxo**.  
- Destaques: Rentabilidade, Risco da Carteira, Lucro.  
- Cards de **Produtos ofertados ativos** levam para:  
  - **[EM DESENVOLVIMENTO]** Empr√©stimos Concedidos.  
  - **[EM DESENVOLVIMENTO]** Negocia√ß√µes de Ofertas (Investidor).  

### 2. A An√°lise e a Contraproposta ‚Äì O Core do Investidor
- **Passo 2a ‚Äì An√°lise (Detalhes da negocia√ß√£o)**  
  - Visualiza√ß√£o da proposta original + contraproposta do tomador.  
  - Diferen√ßa de valores + justificativa escrita.  
  - Perfil detalhado do tomador (Pontua√ß√£o, tempo de conta etc.).  

- **Passo 2b ‚Äì A√ß√£o (Contraproposta)**  
  - Caso n√£o aceite a proposta do tomador.  
  - Tela espelho da negocia√ß√£o do Tomador.  
  - Foco no **Lucro estimado** para a investidora.  

### 3. Telas An√°logas
- Fluxo de cria√ß√£o de uma oferta *(Ofertar empr√©stimo 1-4 etc.)*.  
- Prototipado para mostrar consist√™ncia visual.  
- Fluxo completo seria an√°logo ao de *Solicitar Empr√©stimo* do Tomador.  

---

## üìå Observa√ß√µes Gerais sobre o Prot√≥tipo
- O prot√≥tipo cobre o **‚Äúcaminho feliz‚Äù** e a jornada principal.  
- Telas adicionais n√£o desenvolvidas: recupera√ß√£o de senha, edi√ß√£o de perfil, notifica√ß√µes e configura√ß√µes.  
- O trabalho representa a **espinha dorsal funcional** e a vis√£o de UX do **Negoci.ai**.  


---

## üíµ Modelo de Neg√≥cio/Planejamento Financeiro

### Custos

#### Motor de Score (embutido no mon√≥lito)

| Item | Descri√ß√£o | Frequ√™ncia | Estimativa (R$/m√™s) |
|------|-----------|------------|----------------------|
| **Infraestrutura** | Uso do container √∫nico (backend monol√≠tico) + Redis + Postgres | Cont√≠nuo | incluso na infra (~1.800) |
| **Integra√ß√£o Serasa** | Consulta de score externo com cache 24h | Vari√°vel (depende n¬∫ de usu√°rios) | 2.000 |
| **Equipe Dev/Data** | Desenvolvimento inicial (2 devs backend + 1 data scientist por 3 meses) | Investimento √∫nico | 90.000 (√∫nico) |
| **Manuten√ß√£o Modelo** | Re-treino mensal (data scientist) + monitoramento | Recorrente | 8.000 |
| **Seguran√ßa & Compliance** | Armazenamento seguro, LGPD, auditoria | Anual | 20.000 (‚âà1.700/m√™s) |

**Total Operacional Mensal (score)**: ~11.500  
**Investimento Inicial (score)**: ~90.000  


#### Motor de Recomenda√ß√£o (embutido no mon√≥lito)

| Item | Descri√ß√£o | Frequ√™ncia | Estimativa (R$/m√™s) |
|------|-----------|------------|----------------------|
| **Infraestrutura** | Uso do mesmo container monol√≠tico + Redis | Cont√≠nuo | incluso na infra (~1.800) |
| **Desenvolvimento** | 2 devs backend por 2 meses (l√≥gica de regras e API) | Investimento √∫nico | 60.000 (√∫nico) |
| **Manuten√ß√£o** | Ajuste das regras de recomenda√ß√£o, melhorias de UX | Recorrente | 2.500 |
| **Batch di√°rio** | C√°lculo das faixas de mercado e estat√≠sticas | Recorrente | incluso na infra |
| **Analytics/Auditoria** | Armazenamento de taxas sugeridas para an√°lise | Recorrente | 500 |

**Total Operacional Mensal (recomenda√ß√£o)**: ~2.500  
**Investimento Inicial (recomenda√ß√£o)**: ~60.000  

#### Backend Consolidado (Infraestrutura)

| Item | Descri√ß√£o | Frequ√™ncia | Estimativa (R$/m√™s) |
|------|-----------|------------|----------------------|
| **Container Monol√≠tico** | Execu√ß√£o do backend completo (incluindo os motores) | Cont√≠nuo | 1.800 |
| **Banco de Dados (RDS)** | Postgres relacional | Cont√≠nuo | incluso no valor acima |
| **Redis (ElastiCache)** | Fila/eventos | Cont√≠nuo | incluso no valor acima |

**Total Infra Consolidada**: ~1.800/m√™s   


#### Considera√ß√µes Importantes

- Arquitetura baseada em **mon√≥lito containerizado na AWS** ‚Üí simplifica custos de infra e orquestra√ß√£o.  
- Infraestrutura compartilhada (container, banco, Redis) ‚Üí nada de microsservi√ßos isolados neste est√°gio.  
- Estimativas baseadas em **MVP com 5k‚Äì10k usu√°rios ativos/m√™s**.  
- **Score**: recalculado 1x/dia por usu√°rio ativo (batch).  
- **Recomenda√ß√£o**: usado on-demand ao abrir/criar propostas.  
- **Consultas Serasa**: assumem cache de 24h, custo m√©dio R$ 1‚Äì2 por requisi√ß√£o.  
- Principais custos v√™m de **equipe de desenvolvimento/data science** e **integra√ß√£o externa**.  
- Modelo pensado para **simplicidade e velocidade no MVP**; no futuro pode evoluir para microsservi√ßos se a escala justificar.

---

## üîó Uso da Blockchain Polygon e Smart Contracts

### 1. Por que Blockchain (e por que Polygon)

Imagine o cen√°rio: Carlos (tomador) e Sofia (investidora) negociam um empr√©stimo dentro do app.  
Tudo corre bem at√© surgiram algumas d√∫vidas: **"Ser√° que os termos aceitos s√£o exatamente esses? Ser√° que essa transa√ß√£o realmente foi oficializada?"**  

Tradicionalmente, seria preciso um contrato em papel, custas cartoriais ou confian√ßa cega na plataforma. Contudo, aqui entra a vantagem de se utilizar blockchain: cada negocia√ß√£o aceita √© registrada como um **carimbo digital imut√°vel** na **Polygon**, uma rede p√∫blica, barata e confi√°vel.  

Isso garante que:
- O **tomador** tem certeza de que as condi√ß√µes que aceitou s√£o as que ser√£o cumpridas.  
- O **investidor** confia que sua decis√£o est√° registrada de forma transparente e incontest√°vel.  
- A **plataforma** se posiciona como um √°rbitro neutro, sem poder manipular acordos e controlando a cust√≥dia de valores conforme os termos combinados.  

Este tipo de utiliza√ß√£o garante mais mais confian√ßa, menos burocracia, custo muito menor que cart√≥rios ou sistemas tradicionais. A Blockchain de escolha, considerando o cen√°rio da nossa solu√ß√£o, foi a Polygon, j√° que ela oferece algumas vantagens:

- **Custos baixos**: transa√ß√µes custam centavos de d√≥lar.  
- **Popularidade**: ampla aceita√ß√£o no ecossistema Web3.  
- **Compat√≠vel com ERC-4337 (Account Abstraction)**: permite login com e-mail (Web3Auth), dispensando a gest√£o manual de chaves privadas pelo usu√°rio.  

### 2. Decis√µes de design da blockchain pro MVP

- **On-chain**: registramos apenas um **hash da negocia√ß√£o** (evento-only), suficiente como prova p√∫blica.  
- **Off-chain**: todos os dados sens√≠veis (nome, CPF, score, hist√≥rico, valores) ficam no banco relacional (armazenado em nuvem, atrav√©s do banco RDS).  
- **Wallet autom√°tica**: criada ou logada (caso existente) para o usu√°rio via **Web3Auth** + **Account Abstraction**, simplificando a experi√™ncia, j√° que o usu√°rio n√£o passa pelo atrito de necessidade de gerenciamento de blockchain.  
- **Backend**: garante integridade (gera o hash can√¥nico) e audita o status da transa√ß√£o.  

Em termos de neg√≥cio:  
- Reduzimos custo (pagando apenas por eventos de registro de empr√©stimo na blockchain).  
- Ganhamos a **for√ßa de uma evid√™ncia p√∫blica** em caso de disputas.  
- Entregamos ao usu√°rio uma sensa√ß√£o de **seguran√ßa compar√°vel a um cart√≥rio**, mas em segundos e dentro do app.

---

## Fluxo resumido de uso

1. **Onboarding**: Carlos cria conta com e-mail ‚Üí app detecta que ele n√£o tem uma smart wallet, portanto, gera uma automaticamente.  
2. **Perfil**: o backend consulta score do Serasa e cruza com hist√≥rico de uso.  
3. **Negocia√ß√£o**: Carlos e Sofia trocam propostas at√© chegarem a um acordo.  
4. **Registro on-chain**: o backend gera um `termsHash`, e a smart wallet do usu√°rio assina o envio.  
5. **Confirma√ß√£o**: a blockchain devolve um `tx_hash`, que √© armazenado no banco e exibido para ambos.  

Assim, Carlos sabe que o contrato dele est√° **protegido contra altera√ß√µes**, e Sofia sabe que sua decis√£o est√° **publicamente comprovada**.

## An√°lise de Custos Financeiros da Blockchain

### Premissas do Cen√°rio
- **Usu√°rios ativos**: 5.000  
- **Empr√©stimos/m√™s por usu√°rio**: 5 (cen√°rio improv√°vel, mas bom para stress test)  
- **Total transa√ß√µes/m√™s** = 5.000 √ó 5 = **25.000**  
- **Total transa√ß√µes/ano** = 25.000 √ó 12 = **300.000**  

Cada transa√ß√£o corresponde ao **registro on-chain do hash da negocia√ß√£o** (evento-only).  
O custeio do gas ser√° patrocinado pela solu√ß√£o, via **Paymaster**, evitando preocupa√ß√µes de custos do usu√°rio.  

---

### 1. Custos de Gas ‚Äì Polygon PoS
- **Gas m√©dio por evento**: 50.000 gas  
- **Gas price m√©dio**: 30 gwei (0,00000003 MATIC)  
- **Custo por transa√ß√£o** = 50.000 √ó 30 gwei = **0.0015 MATIC**  
- **Convers√£o (MATIC ~ US$ 0.50)** ‚Üí **US$ 0.00075 por transa√ß√£o**

Totais:
- **Mensal (25.000 tx)** ‚âà **US$ 18,75**  
- **Anual (300.000 tx)** ‚âà **US$ 225,00**

---

## 2. Custos de Identidade ‚Äì Web3Auth (AA + MPC)
- Free tier at√© 1.000 MAUs.  
- Estimativa: **US$ 0.05 / usu√°rio ativo**.  

Totais:
- **Mensal (5.000 usu√°rios)** ‚âà **US$ 250**  
- **Anual** ‚âà **US$ 3.000**

## Modelo de Neg√≥cio

### Custos

#### Motor de Score (embutido no mon√≥lito)

| Item | Descri√ß√£o | Frequ√™ncia | Estimativa (R$/m√™s) |
|------|-----------|------------|----------------------|
| **Infraestrutura** | Uso do container √∫nico (backend monol√≠tico) + Redis + Postgres | Cont√≠nuo | incluso na infra (~1.800) |
| **Integra√ß√£o Serasa** | Consulta de score externo com cache 24h | Vari√°vel (depende n¬∫ de usu√°rios) | 2.000 |
| **Equipe Dev/Data** | Desenvolvimento inicial (2 devs backend + 1 data scientist por 3 meses) | Investimento √∫nico | 90.000 (√∫nico) |
| **Manuten√ß√£o Modelo** | Re-treino mensal (data scientist) + monitoramento | Recorrente | 8.000 |
| **Seguran√ßa & Compliance** | Armazenamento seguro, LGPD, auditoria | Anual | 20.000 (‚âà1.700/m√™s) |

**Total Operacional Mensal (score)**: ~11.500  
**Investimento Inicial (score)**: ~90.000  


#### Motor de Recomenda√ß√£o (embutido no mon√≥lito)

| Item | Descri√ß√£o | Frequ√™ncia | Estimativa (R$/m√™s) |
|------|-----------|------------|----------------------|
| **Infraestrutura** | Uso do mesmo container monol√≠tico + Redis | Cont√≠nuo | incluso na infra (~1.800) |
| **Desenvolvimento** | 2 devs backend por 2 meses (l√≥gica de regras e API) | Investimento √∫nico | 60.000 (√∫nico) |
| **Manuten√ß√£o** | Ajuste das regras de recomenda√ß√£o, melhorias de UX | Recorrente | 2.500 |
| **Batch di√°rio** | C√°lculo das faixas de mercado e estat√≠sticas | Recorrente | incluso na infra |
| **Analytics/Auditoria** | Armazenamento de taxas sugeridas para an√°lise | Recorrente | 500 |

**Total Operacional Mensal (recomenda√ß√£o)**: ~2.500  
**Investimento Inicial (recomenda√ß√£o)**: ~60.000  


#### Backend Consolidado (Infraestrutura)

| Item | Descri√ß√£o | Frequ√™ncia | Estimativa (R$/m√™s) |
|------|-----------|------------|----------------------|
| **Container Monol√≠tico** | Execu√ß√£o do backend completo (incluindo os motores) | Cont√≠nuo | 1.800 |
| **Banco de Dados (RDS)** | Postgres relacional | Cont√≠nuo | incluso no valor acima |
| **Redis (ElastiCache)** | Fila/eventos | Cont√≠nuo | incluso no valor acima |

**Total Infra Consolidada**: ~1.800/m√™s   


#### Considera√ß√µes Importantes

- Arquitetura baseada em **mon√≥lito containerizado na AWS** ‚Üí simplifica custos de infra e orquestra√ß√£o.  
- Infraestrutura compartilhada (container, banco, Redis) ‚Üí nada de microsservi√ßos isolados neste est√°gio.  
- Estimativas baseadas em **MVP com 5k‚Äì10k usu√°rios ativos/m√™s**.  
- **Score**: recalculado 1x/dia por usu√°rio ativo (batch).  
- **Recomenda√ß√£o**: usado on-demand ao abrir/criar propostas.  
- **Consultas Serasa**: assumem cache de 24h, custo m√©dio R$ 1‚Äì2 por requisi√ß√£o.  
- Principais custos v√™m de **equipe de desenvolvimento/data science** e **integra√ß√£o externa**.  
- Modelo pensado para **simplicidade e velocidade no MVP**; no futuro pode evoluir para microsservi√ßos se a escala justificar.

### üíµ **Fontes de Receita Pensadas**

#### 1) Taxa sobre cada empr√©stimo
- **Descri√ß√£o**: cobran√ßa de uma taxa de intermedia√ß√£o em cada contrato fechado.  
- **Modelo poss√≠vel**: percentual sobre o valor do empr√©stimo (ex.: 1%‚Äì3%).  
- **Observa√ß√£o**: precisa de valida√ß√£o jur√≠dica para garantir conformidade com o Banco Central (SEP ‚Äì Sociedade de Empr√©stimo entre Pessoas).

#### 2) Cobran√ßa por inadimpl√™ncia
- **Descri√ß√£o**: taxa administrativa aplicada em casos de atraso, para cobrir custos de cobran√ßa e eventual registro em bureaus de cr√©dito (ex.: Serasa).  
- **Objetivo**: compensar o risco operacional e desestimular o atraso.

#### 3) Parcerias com empresas/servi√ßos
- **Descri√ß√£o**: acordos com terceiros para gera√ß√£o de receita indireta, como:  
  - Seguradoras (prote√ß√£o contra inadimpl√™ncia).  
  - Bureaus de cr√©dito (consultas adicionais).  
  - Institui√ß√µes financeiras (wallets digitais, cust√≥dia).  
- **Objetivo**: diversificar receitas sem onerar diretamente a opera√ß√£o principal.

--- 

## üìà Planos Futuros e Evolu√ß√£o da Plataforma

Para garantir que o *Negoci.ai* continue na vanguarda da inova√ß√£o em empr√©stimos P2P, planejamos tr√™s grandes evolu√ß√µes para o futuro da plataforma, focadas em torn√°-la mais inclusiva, inteligente e precisa.

---

### 1Ô∏è‚É£ Acessibilidade e Inclus√£o Financeira ‚Äì Integra√ß√£o com VLibras

*üìå O Que √©?*  
A Su√≠te *VLibras* √© um conjunto de ferramentas de c√≥digo aberto do Governo Federal que traduz conte√∫dos digitais (textos, √°udios e v√≠deos) para a *L√≠ngua Brasileira de Sinais (Libras)*, tornando plataformas digitais acess√≠veis para a comunidade surda.

**‚öô Como Funciona no Negoci.ai?**  
- Integra√ß√£o via widget flutuante na interface.  
- Ao ativ√°-lo, um avatar 3D traduz em tempo real os textos da tela para Libras.  
- Dispon√≠vel em todas as jornadas, do cadastro √†s negocia√ß√µes.  
- Termos t√©cnicos como Taxa de Juros, Parcela Mensal e Descri√ß√£o da Proposta seriam traduzidos.  

*üéØ Impacto e Vantagens*  
- *Para o Tomador* ‚Äì Democratiza o acesso ao cr√©dito para milh√µes de brasileiros surdos.  
- *Para o Investidor* ‚Äì Aumenta a confian√ßa na plataforma, que demonstra responsabilidade social.  
- *Para a Plataforma* ‚Äì Expande a base de usu√°rios e fortalece a marca como fintech inclusiva e inovadora.  

---

### 2Ô∏è‚É£ Intelig√™ncia de Nicho ‚Äì Modelo de Recomenda√ß√£o por √Årea de Atua√ß√£o

*üìå O Que √©?*  
Um modelo de Machine Learning que vai al√©m do score de cr√©dito. Ele analisa a *√°rea de atua√ß√£o profissional do tomador* e os *interesses do investidor* para sugerir taxas ainda mais personalizadas.

**‚öô Como Funciona no Negoci.ai?**  
- Aprende com dados hist√≥ricos quais √°reas profissionais (ex.: TI, Sa√∫de, Engenharia) t√™m menor inadimpl√™ncia.  
- Sugere taxas com base no nicho profissional.  

*üßë‚Äçüíª Exemplo para o Tomador (Carlos):*  
"Profissionais de TI como voc√™ costumam conseguir taxas pr√≥ximas a 1.2% a.m. Sua proposta √© muito competitiva!"  

*üë©‚Äçüíº Exemplo para a Investidora (Sofia):*  
"Este tomador √© da √°rea de Engenharia. Investidores com seu perfil costumam ter sucesso com ofertas de 1.5% a.m. para este nicho."  

*üéØ Impacto e Vantagens*  
- *Hiper-personaliza√ß√£o* ‚Äì Taxas mais inteligentes e relevantes.  
- *Comunidades de Investimento* ‚Äì Cria√ß√£o de nichos de afinidade entre investidores e tomadores.  
- *Precis√£o de Risco* ‚Äì Adiciona uma camada setorial e comportamental ao risco.  

---

### 3Ô∏è‚É£ An√°lise de Risco 360¬∞ ‚Äì Integra√ß√£o com Open Finance

*üìå O Que √©?*  
Integra√ß√£o com o *Open Finance Brasil, permitindo que usu√°rios compartilhem seus dados financeiros (com consentimento) com o **Negoci.ai*.

**‚öô Como Funciona no Negoci.ai?**  
- Durante cadastro ou solicita√ß√£o, o usu√°rio pode conectar suas contas banc√°rias.  
- Dados s√£o usados para:  
  - *Aprimorar o Modelo de Cr√©dito* ‚Äì Treinar o model_analise_credito.py com dados reais.  
  - *Validar Renda Automaticamente* ‚Äì Eliminando preenchimento manual.  
  - *Calcular M√©tricas Avan√ßadas* ‚Äì Analisar gastos, investimentos e d√≠vidas.  

*üéØ Impacto e Vantagens*  
- *Redu√ß√£o de Fraudes* ‚Äì Dados validados via Open Finance.  
- *Confian√ßa M√°xima para o Investidor* ‚Äì Perfis com hist√≥rico financeiro completo.  
- *Melhores Taxas para o Tomador* ‚Äì Mais poder de negocia√ß√£o com perfil validado.  
